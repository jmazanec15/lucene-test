# Stage to build lucene and luceneutil
FROM eclipse-temurin:24 as build

ARG TEST_REPO
ARG TEST_BRANCH
ARG LUCENEUTIL_REPO

COPY ./build-lucene.sh /
COPY ./build-luceneutil.sh /

RUN bash /build-lucene.sh ${TEST_REPO} ${TEST_BRANCH}
RUN bash /build-luceneutil.sh ${LUCENEUTIL_REPO}
RUN ls

# Build the actual image
FROM eclipse-temurin:24
COPY --from=build /hello2.txt /
COPY ./custom-entrypoint.sh /
ENTRYPOINT ["/bin/bash", "/custom-entrypoint.sh"]
